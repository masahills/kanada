# Kanada - 日本語テキスト変換ライブラリ

Kanada は、KAKASI をベースに一から再実装された、ピュアJava製の日本語処理ライブラリです。
漢字かな混じりの日本語テキストをひらがな・カタカナ・ローマ字に変換し、自然な分かち書きにも対応しています。
さらに、生成AIによるアシスト機能を加えることで、変換精度の向上を実現しています。

## 主な機能

- **漢字からかな変換**
    - 漢字をひらがなやカタカナに簡単に変換できます

- **ローマ字変換**
    - 日本語テキストをローマ字に変換します

- **複数のローマ字システム**
    - ヘボン式、訓令式、その他のローマ字システムをサポートしています

- **分かち書き**
    - 文章の単語間に自動的にスペースを挿入し、可読性を向上させます

- **ふりがなモード**
    - 漢字の読みをふりがなとして付与します

- **半角全角変換**
    - 半角・全角文字間でさまざまなパターンの変換ができます

- **純粋なJava実装**
    - 最小限の外部依存でJavaのみで実装されています

- **軽量設計**
    - 形態素解析を必要とせず、速度と効率性を重視して設計されています

## 新機能

- **生成AI支援による読みの選択 (ベータ版)**
    - 生成AIを活用して文脈における漢字読みの変換精度を向上
    - OpenAI API、Anthropic API (Claude)、Ollama とのインテグレーションをサポート
    - 設定ファイル `config.json` により、モデルごとのプロンプト調整が可能
    - これまで課題であった文脈に合わせた読みの選択を、生成AIの自然言語処理で解決
    - 複数の読み候補がある時にのみ生成AIを使用し、処理の高速性を確保
    - 必要な場合に限ってプロンプトを送信するためトークン消費を節約
    - 従来の軽量な辞書ベースの変換方式と生成AIを併用することで、高速でより高精度な変換を実現


- **日本語かな点字（6点点字）の自動逆翻訳 (アルファ版)**
    - 日本語の6点点字パターンを、ひらがな・カタカナ・ローマ字へ逆変換
    - かな文字に対応した標準的な日本語点字記法をサポート
    - アクセシビリティアプリや点字テキスト処理ワークフローへの応用が可能
    - BRF/BSE形式のファイルをUnicode点字パターンへ変換するPythonスクリプトも同梱


- **日本語テキストの自動点訳 (試作版)**
    - 漢字かな混じりの日本語テキストからUnicode点字パターンへ自動点訳します
        - 試作中のため機能は不完全です（助詞「は」から「わ」への変換、外国語引用符など未対応）
    - 分かち書きは点訳における一般的な文節区切りとは正確に一致しない場合があります
    - 印刷向けの出力ではないため、1行文字数・1ベージ行数などの調整はしていません
        - Unicode点字パターンからBRF/BSE形式ファイルへの変換スクリプトを提供する予定です

## クイックスタート

### Gradle

```gradle
dependencies {
    implementation 'com.iciao:kanada:1.0.0'
}
```

### 基本的な使用方法

```java
import com.iciao.kanada.Kanada;

// 静的メソッドによる簡単な変換
String romaji = Kanada.toRomaji("日本語");     // "nihongo"
        String hiragana = Kanada.toHiragana("日本語"); // "にほんご"
        String katakana = Kanada.toKatakana("日本語");  // "ニホンゴ"
```

### 高度な使用方法（ビルダーパターン）

```java
import com.iciao.kanada.Kanada;

// スペースと大文字化を含むカスタマイズされた変換
Kanada converter = Kanada.create()
        .toRomaji()
        .withSpaces()
        .upperCaseFirst();

        String result = converter.process("進撃の巨人"); // "Shingeki No Kyojin"

        // または一行で
        String result = Kanada.create().toRomaji().withSpaces().process("進撃の巨人");
```

## 設計の詳細

### 辞書ベースアプローチ

Kanadaでは形態素解析を行わず、すべての変換（かな変換・ローマ字変換・分かち書き）は辞書ベースのアプローチで行われます。

- **辞書ベースパターンマッチング**
    - 文字パターンの辞書検索によりテキストを処理
- **簡略化された単語境界推定**
    - 文字種の遷移に基づく単語境界の推定

### 制限事項

- 形態素解析を行わないため、文脈にあった読みに変換できないことがあります
- 同一単語に複数の読みがある場合、辞書の登録順序に依存した結果になります
- 分かち書きは言語学的な文節とは正確に一致しない場合があります
- 固有名詞は一般的な読みと異なってしまう場合があります
- 複合語が分割されてしまう場合があります
- 辞書ファイル（`dictionary/japanese/`ディレクトリ）を編集することで、ある程度は変換精度を向上できます

## 開発環境セットアップ

開発時は、かな文字のマッピングファイルをまず生成してください：

```bash
# TSVからKanaMapping.javaを生成
./gradlew generateMapping
```

## ビルド

```bash
# フルビルド（マッピング生成を含む）
./gradlew build
```

**注意**: `KanaMapping.java`は`tools/mappings/kanatable.tsv`から生成されるため、手動で編集しないでください。

## サンプル実行

```bash
./gradlew :examples:run
```

## ライセンス

このプロジェクトはデュアルライセンスで配布されています：

- **Kanadaライブラリソースコード**: MITライセンス - 詳細はMIT-LICENSEファイルを参照してください。
- **辞書ファイル**: GPL v2 - `dictionary/japanese/`ディレクトリのkakasidictファイルはKAKASIプロジェクト由来でGPL
  v2ライセンスです。詳細はLICENSEファイルを参照してください。

  **注意**: SKK辞書もサポートしていますが、このパッケージには含まれていません。SKK辞書もGPL
  v2ライセンスです。用途に合わせて、SKKの各種辞書ファイルを使用できます。

このデュアルライセンスにより、辞書ファイルの元のライセンスを尊重しながら、オープンソースおよびプロプライエタリプロジェクトの両方でKanadaライブラリを使用できます。
